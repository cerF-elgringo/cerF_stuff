<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>GLABDLE</title>
<link href="https://fonts.cdnfonts.com/css/grobold" rel="stylesheet">

<style>
* { box-sizing: border-box; margin:0; padding:0; }
html, body {
    height: 100%; width: 100%; overflow-x: hidden;
    font-family: 'GROBOLD', sans-serif;
    display: flex; justify-content: center; align-items: center;
    background-color: black;
    color: #206cd2;
    background-image: url('https://hosky.io/_next/image?url=%2F_next%2Fstatic%2Fmedia%2FHosky_1200.9361cc3f.png&w=3840&q=85&dpl=dpl_A35He1TJdeTQghKRghvecRxzGvvJ');
    background-repeat: repeat;
    background-size: 150px 150px;
}

#game-wrapper {
    display: none; /* hidden until mode selected */
    flex-direction: column; align-items: center;
    background-color: rgba(0,0,0,0.5);
    min-width: 340px; max-width: 90vw; padding: 20px;
    border-radius: 10px;
}

h1 { font-size: 72px; margin-bottom: 20px; color: #206cd2;
    text-shadow: 0 0 5px #00ff00, 0 0 20px #00ff00, 0 0 30px #00ff00;
}

#game-container { display: grid; grid-template-rows: repeat(6, 60px); grid-gap: 10px; margin-bottom: 20px; }
.row { display: grid; grid-template-columns: repeat(5, 60px); grid-gap: 10px; }
.cell { 
    width: 60px; 
    height: 60px; 
    border: 2px solid #206cd2; 
    display: flex; 
    justify-content: center; 
    align-items: center; 
    font-size: 36px; 
    text-transform: uppercase; 
    color: #206cd2; 
    background-color: black; 
    user-select: none; 
    border-radius: 6px; /* slightly rounded corners */
}
.cell.active { border-color: #ffc107; box-shadow: 0 0 10px #ffc107; }
.green { background-color: #206cd2; color: black; }
.yellow { background-color: #ffc107; color: black; }
.gray { background-color: #555; color: black; }
.cell.locked { pointer-events: none; opacity: 0.6; user-select: none; }

#alphabet { display: flex; flex-wrap: wrap; max-width: 420px; justify-content: center; gap: 5px; margin-top: 10px; }
.letter-box { 
    width: 38px; 
    height: 38px; 
    border: 3.5px solid #206cd2; 
    display: flex; 
    justify-content: center; 
    align-items: center; 
    text-transform: uppercase; 
    color: #206cd2; 
    font-size: 18px; 
    user-select: none; 
    border-radius: 6px; /* slightly rounded corners */
}

.letter-box:hover {
    background-color: #206cd2; /* bright blue on hover */
    color: black;              /* text contrast */
    transform: scale(1.1);     /* slight grow effect */
    box-shadow: 0 0 8px #206cd2; /* subtle glow */
}

#mobile-input { position: absolute; opacity: 0; width: 1px; height: 1px; }

#win-gif-container, #lose-gif-container { display: none; opacity: 0; transition: opacity 1s ease; position: fixed; top:50%; left:50%; transform: translate(-50%, -50%); z-index: 9999; width: 450px; max-width: 90%; }

#win-message, #lose-message { 
    display: none; 
    position: fixed; 
    top: 50%; 
    left: 50%; 
    transform: translate(-50%, -50%) rotate(0deg);
    font-size: 84px; 
    line-height: 1.1;
    text-align: center; 
    z-index: 9998; 
    background: linear-gradient(90deg, red, orange, yellow, green, blue, indigo, violet); 
    background-size: 300% 100%; 
    -webkit-background-clip: text; 
    -webkit-text-fill-color: transparent; 
    filter: drop-shadow(0 0 6px #ff69b4) drop-shadow(0 0 12px #ff69b4);
    animation: gradientMove 0.8s linear infinite alternate, wiggle 0.2s ease-in-out infinite alternate;
    overflow: visible;
}

/* Rainbow gradient movement */
@keyframes gradientMove { 
    0% { background-position: 0% 50%; } 
    50% { background-position: 150% 50%; } 
    100% { background-position: 300% 50%; } 
}

@keyframes revealLetter {
    0% {
        transform: scale(0.9);
        opacity: 0.7;
    }
    50% {
        transform: scale(1.2);
        opacity: 1;
    }
    100% {
        transform: scale(1);
        opacity: 1;
    }
}

/* Quick wiggle rotation */
@keyframes wiggle {
    0% { transform: translate(-50%, -50%) rotate(-2deg); }
    50% { transform: translate(-50%, -50%) rotate(2deg); }
    100% { transform: translate(-50%, -50%) rotate(-2deg); }
}
.lose-poo { position: fixed; top: 10px; font-size: 180px; display: none; z-index: 10000; user-select: none; pointer-events: none; }
#lose-poo-left { left: 20px; }
#lose-poo-right { right: 20px; }
.falling-poo { position: absolute; pointer-events: none; user-select: none; animation-name: fall; animation-timing-function: linear; }
@keyframes fall { 0% { transform: translateY(-200px) rotate(0deg); } 100% { transform: translateY(100vh) rotate(720deg); } }

#games-counter { position: fixed; top: 10px; right: 10px; font-size: 14px; color: #206cd2; z-index: 10001; font-family: 'GROBOLD', sans-serif; }

/* MODE BUTTONS */
#mode-select-overlay {
    position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.95); z-index: 100000;
    display:flex; flex-direction:column; justify-content:center; align-items:center;
    gap: 20px;
}
.mode-btn {
    font-family:'GROBOLD', sans-serif; 
    font-size:32px; 
    color:#206cd2; 
    background:black; 
    border:2px solid #206cd2; 
    padding:15px 30px; 
    cursor:pointer;
    text-transform:uppercase; 
    box-shadow:0 0 0 #ff9900; 
    transition:0.3s;
    border-radius: 8px; /* <- new, matches cells/keyboard rounding */
}
.mode-btn:hover { box-shadow:0 0 15px #ff9900; color:#ffc107; border-color:#ffc107; }
.mode-title {
    font-size: 48px;
    color: #cccccc; /* light grey text */
    text-shadow: 
        0 0 2px #888888,   /* subtle inner glow */
        0 0 6px #666666;   /* soft outer glow */
}
.enter-box {
    width: 80px;        /* elongated to fit "ENTER" */
    height: 36px;       /* same height as other letters */
    background-color: #00ff00;
    color: black;
    font-weight: bold;
    border-radius: 6px; /* same as letters */
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    font-size: 14px;    /* slightly smaller so "ENTER" fits */
    transition: all 0.2s ease;
}

.enter-box:hover {
    background-color: #0000FF;
    transform: scale(1.05);  /* subtle hover scale */
}
@media (max-width:500px){.mode-btn{font-size:24px;padding:10px 20px}.mode-title{font-size:32px}}
</style>
</head>
<body>

<div id="mode-select-overlay">
    <h1 style="font-size:72px; color:#206cd2; text-shadow: 0 0 10px #00ff00, 0 0 20px #00ff00, 0 0 30px #00ff00; margin-bottom:20px;">GLABDLE</h1>
    <h2 class="mode-title">Choose Mode</h2>
    <div style="display:flex; gap:20px;">
        <button class="mode-btn" id="hosky-btn">HOSKY Words</button>
        <button class="mode-btn" id="normal-btn">NORMAL Words</button>
    </div>
</div>

<div id="game-wrapper">
    <div id="lose-poo-left" class="lose-poo">ðŸ’©</div>
    <div id="lose-poo-right" class="lose-poo">ðŸ’©</div>
    <h1>GLABDLE</h1>
    <div id="game-container">
        <div class="row" id="row0"></div>
        <div class="row" id="row1"></div>
        <div class="row" id="row2"></div>
        <div class="row" id="row3"></div>
        <div class="row" id="row4"></div>
        <div class="row" id="row5"></div>
    </div>
    <div id="alphabet"></div>
</div>

<input type="text" id="mobile-input" maxlength="5" />

<div id="win-gif-container"></div>
<div id="lose-gif-container"></div>

<div id="win-message">GOOD JOB IDJIOT</div>
<div id="lose-message">Try again, idjiot</div>

<!-- DEBUG SECRET WORD -->
  <div id="debug-word" style="position: fixed; top: 10px; right: 10px; font-size: 16px; color: #ff9900; z-index: 10002; font-family: 'GROBOLD', sans-serif; display: none;">
      SECRET: <span id="debug-word-text"></span>
  </div>

<div id="games-counter">Total games submitted: <span id="games-count">0</span></div>

<script type="text/javascript" async src="https://tenor.com/embed.js"></script>

<script>
// --- GAME MODE VARIABLES ---
let selectedMode = 'HOSKY'; // default
let targetWord = "HOSKY";   // must be let, can change for NORMAL
const extraWords = ["HOSKY","GLABS"];
const triggerWords = ["SAYOS","VEGAS","JINXY","CERFY","GLABS"];
const gameWrapper = document.getElementById('game-wrapper');
const winningGifs = ["4540374823853696704","24111898","24123953","10534076","7551288617603856546"];
async function isValidWord(word){
// ALWAYS allow the secret word
    if (word.toUpperCase() === targetWord.toUpperCase()) {
        return true;
    }
    word = word.toLowerCase();
    if(extraWords.includes(word.toUpperCase())) return true;  // allow custom words like HOSKY, GLABS
    try {
        const res = await fetch(`https://api.dictionaryapi.dev/api/v2/entries/en/${word}`);
        return res.ok;  // âœ… returns true if word exists in dictionary
    } catch(e) {
        return false; // API failed â†’ treat as invalid
    }
}
const profaneWords = ["fuck","shit","bitch","bastard","dick","cunt","asshole","nigger","faggot","slut","whore","cock","pussy","douche"];
function checkProfanity(word){return profaneWords.some(p=>word.toLowerCase().includes(p));}

// --- MODE BUTTONS LOGIC (BOARD VISIBLE AFTER CLICK) ---
document.getElementById('hosky-btn').addEventListener('click', () => {
    selectedMode = 'HOSKY';
    targetWord = "HOSKY";
    document.getElementById('mode-select-overlay').style.display = 'none';
    gameWrapper.style.display = 'flex';
});

document.getElementById('normal-btn').addEventListener('click', () => {
    selectedMode = 'NORMAL';
    document.getElementById('mode-select-overlay').style.display = 'none';
    gameWrapper.style.display = 'flex';

    // Fetch random 5-letter word
    fetch('https://random-word-api.vercel.app/api?words=1&length=5')
        .then(res => res.json())
        .then(data => {
            // API returns array: ["apple"]
            targetWord = data[0].toUpperCase();
            console.log("NORMAL target word:", targetWord);

            const debugDiv = document.getElementById('debug-word');
            debugDiv.style.display = 'block';
            document.getElementById('debug-word-text').textContent = targetWord;
        })
        .catch(err => {
            console.error("Error fetching normal word:", err);
            targetWord = "APPLE"; // fallback

            const debugDiv = document.getElementById('debug-word');
            debugDiv.style.display = 'block';
            document.getElementById('debug-word-text').textContent = targetWord;
        });
});

// --- CREATE CELLS ---
function createCells(row,rowIndex){
    for(let i=0;i<5;i++){
        const cell = document.createElement('div');
        cell.classList.add('cell');
        row.appendChild(cell);
        cell.addEventListener('click', ()=>{if(rowIndex===currentRow && !gameOver){currentCol=i;updateActiveCell(); if(window.innerWidth <= 500) document.getElementById('mobile-input').focus(); row.scrollIntoView({behavior:'smooth', block:'center'});}});
    }
}
for(let i=0;i<6;i++) createCells(document.getElementById(`row${i}`), i);

// --- ALPHABET + ENTER KEY ---
const alphabetContainer = document.getElementById('alphabet');
for (let l of "ABCDEFGHIJKLMNOPQRSTUVWXYZ") {
    const box = document.createElement('div');
    box.classList.add('letter-box');
    box.id = `letter-${l}`;
    box.textContent = l;
    alphabetContainer.appendChild(box);
}

// ENTER key
const enterBox = document.createElement('div');
enterBox.classList.add('letter-box', 'enter-box');
enterBox.textContent = 'ENTER';
alphabetContainer.appendChild(enterBox);
// --- MAKE ALPHABET CLICKABLE ---
document.querySelectorAll('.letter-box').forEach(box => {
    box.addEventListener('click', () => {
        const letter = box.textContent;
        if (letter === 'ENTER') {
            handleKey('Enter'); // trigger enter functionality
        } else {
            handleKey(letter);  // regular letter
        }
        mobileInput.focus(); // optional: keep focus on mobile input
    });
});
// --- GAME FUNCTIONS ---
function updateAlphabet(letter,state){
    const box=document.getElementById(`letter-${letter}`);
    if(!box) return;
    if(state==='green'){box.style.backgroundColor='#206cd2'; box.style.color='black';}
    else if(state==='yellow'){box.style.backgroundColor='#ffc107'; box.style.color='black';}
    else{box.style.backgroundColor='#555'; box.style.color='black';}
}

function updateActiveCell(){
    document.querySelectorAll('.cell').forEach(c=>c.classList.remove('active'));
    const cells=document.getElementById(`row${currentRow}`).querySelectorAll('.cell');
    if(currentCol<5) cells[currentCol].classList.add('active');
    if(window.innerWidth <= 500){setTimeout(()=>document.getElementById(`row${currentRow}`).scrollIntoView({behavior:'smooth', block:'center'}),50);}
}

function setBlur(enable){gameWrapper.style.filter=enable?'blur(5px)':'none';}
function fadeIn(el){el.style.display='block';requestAnimationFrame(()=>el.style.opacity='1');}
function fadeOut(el){el.style.opacity='0';setTimeout(()=>el.style.display='none',1000);}
function startPoopRain(count=16){for(let i=0;i<count;i++){const poop=document.createElement('div');poop.classList.add('falling-poo');poop.textContent='ðŸ’©';poop.style.left=Math.random()*(window.innerWidth-100)+'px';poop.style.fontSize=(110+Math.random()*120)+'px';poop.style.animationDuration=(10+Math.random()*6)+'s';document.body.appendChild(poop);poop.addEventListener('animationend',()=>poop.remove());}}
function startLosePoopRain(count=12){for(let i=0;i<count;i++){const poop=document.createElement('div');poop.classList.add('falling-poo');poop.textContent='ðŸ’©';poop.style.left=Math.random()*(window.innerWidth-80)+'px';poop.style.fontSize=(60+Math.random()*80)+'px';poop.style.animationDuration=(5+Math.random()*5)+'s';document.body.appendChild(poop);poop.addEventListener('animationend',()=>poop.remove());}}

// --- SESSION STORAGE ---
function saveGameState(){
    const state={currentRow,currentCol,board:[],gameOver};
    for(let r=0;r<6;r++){
        const cells=document.getElementById(`row${r}`).querySelectorAll('.cell');
        state.board.push(Array.from(cells).map(c=>({letter:c.textContent,classes:c.className})));
    }
    const alphabetState={};
    "ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("").forEach(l=>{const box=document.getElementById(`letter-${l}`); if(box) alphabetState[l]=box.style.backgroundColor;});
    state.alphabet = alphabetState;
    sessionStorage.setItem('glabble_state',JSON.stringify(state));
}

function loadGameState(){
    const state = JSON.parse(sessionStorage.getItem('glabble_state')); if(!state) return;
    currentRow = state.currentRow; currentCol = state.currentCol; gameOver = state.gameOver || false;
    for(let r=0;r<6;r++){
        const cells=document.getElementById(`row${r}`).querySelectorAll('.cell');
        cells.forEach((c,i)=>{c.textContent=state.board[r][i].letter;c.className=state.board[r][i].classes;});
    }
    if(state.alphabet){for(let l in state.alphabet){const box=document.getElementById(`letter-${l}`); if(box) box.style.backgroundColor=state.alphabet[l];}}
    updateActiveCell(); if(gameOver) mobileInput.blur();
}

// --- INPUT ---
const mobileInput=document.getElementById('mobile-input');
let currentRow=0,currentCol=0,gameOver=false;

mobileInput.addEventListener('input',e=>{const value=e.target.value.toUpperCase();if(value.length>0){handleKey(value[value.length-1]);mobileInput.value='';}});
document.addEventListener('keydown',e=>handleKey(e.key));
if(window.innerWidth<=500){window.addEventListener('load',()=>{mobileInput.focus(); setTimeout(()=>document.getElementById(`row${currentRow}`)?.scrollIntoView({behavior:'smooth', block:'center'}),50);});}

// --- TOTAL GAMES COUNTER ---
let totalGames=parseInt(localStorage.getItem('glabble_totalGames')||'0');
document.getElementById('games-count').textContent=totalGames;


// --- HANDLE KEYS ---
async function handleKey(key){
    if(gameOver) return;
    const row = document.getElementById(`row${currentRow}`);
    const cells = row.querySelectorAll('.cell');

    if(key==='Backspace'){
        if(cells[currentCol].textContent===""){if(currentCol>0) currentCol--;cells[currentCol].textContent="";}else{cells[currentCol].textContent="";}
        updateActiveCell(); saveGameState(); return;
    }
    if(key==='Enter'){
        if(Array.from(cells).every(c=>c.textContent!=="")){
            const guess=Array.from(cells).map(c=>c.textContent).join('').toUpperCase();
            await processGuess(guess);
        }
        return;
    }
    if(/^[a-zA-Z]$/.test(key)){
        if(currentCol<5){cells[currentCol].textContent=key.toUpperCase();if(currentCol<4) currentCol++; updateActiveCell(); saveGameState();}
    }
}

// --- PROCESS GUESS ---
const redirects={
    "SAYOS":["https://en.wikipedia.org/wiki/Burbot","https://www.mazda.com/en/","https://www.youtube.com/watch?v=K1fyza5BN-0","https://www.hkmaps.hk/viewer.html","https://www.youtube.com/watch?v=YJFNdIJnrHY","https://www.spanishdict.com/translate/sayos"],
    "VEGAS":["https://x.com/HoskyDevVegas/status/1947043091216494826","https://www.dreamvacations.com/vacation/destinations/all","https://www.youtube.com/watch?v=1DUaR0zBGgQ","https://www.christinascucina.com/beans-on-toast-the-proper-british-way-recipe-by-a-brit/","https://www.urbandictionary.com/define.php?term=foo-foo%20drink"],
    "JINXY":["https://en.wikipedia.org/wiki/Flat_bean","https://www.reddit.com/r/Netherlands/comments/1ghutfw/what_are_some_crucial_traditional_dutch/","https://www.thedutchtable.com/2010/10/bitterballen-dutch-deep-fried-gravy.html"],
    "CERFY":["https://www.youtube.com/watch?v=aBquLj4kLxQ","https://www.youtube.com/watch?v=4npQAvzrND0","https://www.imdb.com/title/tt1990216/","https://www.youtube.com/watch?v=_ngkB44qaQw"],
    "GLABS":["https://www.jpg.store/collection/hoskycashgrab?tab=items&filters=eyJmdXIiOlsiR29sZGVuIExhYnJhZG9yIl19"]
};

async function processGuess(guess){
    const row = document.getElementById(`row${currentRow}`);
    const cells = row.querySelectorAll('.cell');

    // âœ… Check if guess is valid
    if(!triggerWords.includes(guess) && !(await isValidWord(guess))){
    alert("THAT AIN'T NO REAL WERD, IDJIOT!");
    // CLEAR THE CURRENT ROW
    const cells = document.getElementById(`row${currentRow}`).querySelectorAll('.cell');
    cells.forEach(c => c.textContent = "");
    currentCol = 0;
    updateActiveCell();
    saveGameState();
    return;
}

    // --- Prepare counts for correct coloring ---
    const targetLetters = targetWord.split('');
    const guessLetters = guess.split('');
    const letterCounts = {}; // track remaining letters for yellow check

    targetLetters.forEach(l => {
        letterCounts[l] = (letterCounts[l] || 0) + 1;
    });

    // --- First pass: mark greens ---
    const results = Array(5).fill('gray');
    for(let i=0; i<5; i++){
        if(guessLetters[i] === targetLetters[i]){
            results[i] = 'green';
            letterCounts[guessLetters[i]]--;
        }
    }

    // --- Second pass: mark yellows ---
    for(let i=0; i<5; i++){
        if(results[i] === 'gray' && letterCounts[guessLetters[i]] > 0){
            results[i] = 'yellow';
            letterCounts[guessLetters[i]]--;
        }
    }

    // --- Apply colors to cells & alphabet ---
    for(let i=0; i<5; i++){
    cells[i].classList.remove('green','yellow','gray');
    cells[i].classList.add(results[i]);
    updateAlphabet(cells[i].textContent, results[i]);
    
    // add a small staggered delay per letter
    cells[i].style.animation = `revealLetter 0.6s ease forwards ${i*0.15}s`; 
    cells[i].addEventListener('animationend', () => { cells[i].style.animation = ''; }, { once: true });
}

    cells.forEach(c => c.classList.add('locked'));
    saveGameState();

    // --- Check win ---
    if(guess === targetWord){
    gameOver = true; 
    mobileInput.blur(); 
    saveGameState();

    // Delay everything (blur + animations) so squares reveal first
    setTimeout(() => {
        setBlur(true);                 // move blur inside delay
        showWinningGif(); 
        startPoopRain(80);

        setTimeout(() => { 
            fadeOut(document.getElementById('win-gif-container')); 
            document.getElementById('win-message').style.display='block'; 
        }, 4000);

        setTimeout(() => { 
            window.location.href="https://hosky.io"; 
        }, 8000);

    }, 800); // 0.8s delay
    return;
}

    // --- Check lose ---
    if(currentRow === 5){
        gameOver = true; setBlur(true); mobileInput.blur(); saveGameState();
        document.getElementById('lose-poo-left').style.display='block';
        document.getElementById('lose-poo-right').style.display='block';
        startLosePoopRain(40);
        const loseGifs=["6289320449545116130","24576363","5408039","1639610178022128587","1514012758219765433"];
        const gifContainer=document.getElementById('lose-gif-container');
        const randomId=loseGifs[Math.floor(Math.random()*loseGifs.length)];
        gifContainer.innerHTML="";
        const embedDiv=document.createElement("div");
        embedDiv.className="tenor-gif-embed";
        embedDiv.setAttribute("data-postid",randomId);
        embedDiv.setAttribute("data-share-method","host");
        embedDiv.setAttribute("data-aspect-ratio","1");
        embedDiv.setAttribute("data-width","100%");
        gifContainer.appendChild(embedDiv);
        const script=document.createElement("script"); 
        script.type="text/javascript"; 
        script.async=true; 
        script.src="https://tenor.com/embed.js"; 
        gifContainer.appendChild(script);
        fadeIn(gifContainer);
        setTimeout(() => { fadeOut(gifContainer); document.getElementById('lose-message').style.display='block'; }, 4000);
        setTimeout(() => { window.location.href="https://hosky.io"; }, 8000);
        return;
    }

    // --- Trigger & Profanity ---
    if(checkProfanity(guess)){
        currentRow++; currentCol=0; updateActiveCell(); saveGameState();
        window.open("https://www.reddit.com/r/Rants/comments/p1vrsr/when_people_say_keep_it_pg_do_they_mean_keep_it/", '_blank');
        return;
    }

    if(triggerWords.includes(guess)){
        currentRow++; currentCol=0; updateActiveCell(); saveGameState();
        const links = redirects[guess];
        const randomLink = links[Math.floor(Math.random() * links.length)];
        window.open(randomLink, '_blank');
        return;
    }

    // --- Next row ---
    currentRow++; currentCol=0; updateActiveCell(); saveGameState();
}

// --- SHOW WIN GIF ---
function showWinningGif(){
    const gifContainer=document.getElementById('win-gif-container');
    const randomId=winningGifs[Math.floor(Math.random()*winningGifs.length)];
    gifContainer.innerHTML="";
    const embedDiv=document.createElement("div");
    embedDiv.className="tenor-gif-embed";
    embedDiv.setAttribute("data-postid",randomId);
    embedDiv.setAttribute("data-share-method","host");
    embedDiv.setAttribute("data-aspect-ratio","1");
    embedDiv.setAttribute("data-width","100%");
    gifContainer.appendChild(embedDiv);
    const script=document.createElement("script"); script.type="text/javascript"; script.async=true; script.src="https://tenor.com/embed.js"; gifContainer.appendChild(script);
    fadeIn(gifContainer);
}

updateActiveCell();
</script>
</body>
</html>
